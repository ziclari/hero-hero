scene:
  background: bg_exit
  slides:
    - id: exit_1
      elements:
        - type: text
          content: EXIT DOOR
          top: 50
          left: 50
          className: heading-text

        - type: text
          content: |
            Keypad Active.
            Enter Code:
          top: 300
          left: 500
          width: 900
          className: bubble

        # Correct Code (Win)
        - type: button
          text: "7 - 3 - 9 - 1"
          top: 500
          left: 600
          variant: primary
          action:
            - next_slide

        # Wrong Code (Fail/Loop)
        - type: button
          text: "1 - 2 - 3 - 4"
          top: 500
          right: 600
          variant: primary
          action:
            - goto_scene:intro
            - custom_inc:loop_count
            # Reset items for next loop? Or keep them? 
            # "Groundhog Day" usually keeps memory but resets physical items.
            # Let's reset fuse but keep code knowledge? Or reset all?
            # For this test, let's just increment loop count and keep items to make it easier.

    - id: exit_win
      elements:
        - type: text
          content: |
            ACCESS GRANTED.
            DOOR UNLOCKED.
            
            YOU ESCAPED IN {{ custom.loop_count }} LOOPS.
          top: 300
          left: 500
          width: 900
          className: bubble

        - type: button
          text: RESET SIMULATION
          top: 800
          left: 830
          variant: primary
          action:
            - custom_set_persistent:loop_count,local,1
            - custom_set_persistent:has_fuse,local,false
            - custom_set_persistent:knows_code,local,false
            - goto_scene:intro
  assets:
    images:
      bg_exit:
        src: https://images.unsplash.com/photo-1503803548695-c2a7b4a5b875?w=620&auto=format&fit=crop&q=60&ixlib=rb-4.1.0
